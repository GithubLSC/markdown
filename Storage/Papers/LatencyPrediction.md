# Latency Prediction

## 主要文章

+ [==SSDCheck==](https://dl.acm.org/doi/10.1145/3440022)

> 21' ToS

+ [==LinnOS==](https://www.usenix.org/conference/osdi20/presentation/hao)

> 20' OSDI

## 研究背景

两者主要关注闪存的尾端延迟问题，基本应用场景为数据存在多备份，分布式系统。

+ ssdcheck 关注读延迟和写延迟。
+ linnos认为写延迟被写buffer缓冲，尾端延迟不太影响性能。因此主要针对读延迟的预测。
+ 什么原因 导致的尾端延迟？
  + SSDcheck 通过FPGA 对尾端延迟组成分析出尾端延迟的原因为WB和GC，进而建模模拟WB和GC的基本流程。
  + Linnos 把SSD当作黑盒，认为所有的尾端延迟请求面临着相似的状态，因此采用神经网络的方式进行分类。
  + 混合式存储设备的读写性能分析。
    1. 由于混合式SSD积极的迁移策略，混合式存储设备写性能在容量充足的情况下，不存在严重的尾端延迟问题。
    2. QLC的读延迟比PSLC要慢几倍，而数据究竟在PSLC还是QLC主机端并不能感知，但总的来说，相差不大，可以假定QLC读取延迟作为的基本读性能。除此之外，尾端延迟现象是否明显有待进一步确认。
  + 影响混合式存储设备尾端延迟的主要原因有待确认，严格确认需要FPGA支持。
  + 混合式存储设备单盘方案，预测尾端延迟是否能避开经典的尾端延迟问题，针对性进行分析
+ 为什么  预测尾端延迟而不是解决尾端延迟？
  + 大多策略将SSD作为白盒或者灰盒，进行针对性（控制器层面、文件系统层面）的优化，但归根结底，SSD厂商根本不愿意采纳，并无实际价值。
  + 分布式，多备份场景，预测尾端延迟能掩盖单设备的突发性能问题，而避免尾端延迟带来的影响。

## 解决方案

### 尾端延迟分类

SSDcheck和LinnOS为了提升预测的准确度，都采用二分类的方式展示预测准确度。在拐点确定上，二者有不同的策略。

+ SSDcheck 

SSDCheck比较直接，选取99%的延迟作为分界点。

+ LinnOS

LinnOS采用了拐点算法，通过计算曲线45°点 左右每个点 的面积，来确定拐点。

### 输入特征

+ SSDcheck 模拟了GC和WB两个基本操作，同时维护了一个历史延迟窗口进行精确时间预测。
+ Linnos提取了请求的队列情况，以及最近N条请求的延迟情况。

### 矫正模块

+ SSDcheck 采用实时延迟检测的方式，对内部GC和WB模块修正。
+ LinnOS 检测 提交错误率 ，在拐点发生一定偏移量后，重新生成训练数据集，更新神经网络的神经元权重。

## 实验

### 设备负载

SSDCheck和LinnOS都采用多个厂商的多台设备

- ​	SSDcheck 主要采用SATA
- ​	Linnos Sata和Nvme设备 都有选用

### 对比指标

+ SSDcheck 主要是提出了许多use case ，因此都在和baseline做比较
+ Linnos 比较了 Clone Hedge baseline 等四类相关的工作。
